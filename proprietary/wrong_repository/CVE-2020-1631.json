{"cve":"CVE-2020-1631","description":"A vulnerability in the HTTP/HTTPS service used by J-Web, Web Authentication, Dynamic-VPN (DVPN), Firewall Authentication Pass-Through with Web-Redirect, and Zero Touch Provisioning (ZTP) allows an unauthenticated attacker to perform local file inclusion (LFI) or path traversal. Using this vulnerability, an attacker may be able to inject commands into the httpd.log, read files with  world  readable permission file or obtain J-Web session tokens. In the case of command injection, as the HTTP service runs as user  nobody , the impact of this command injection is limited. (CVSS score 5.3, vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) In the case of reading files with  world  readable permission, in Junos OS 19.3R1 and above, the unauthenticated attacker would be able to read the configuration file. (CVSS score 5.9, vector CVSS:3.1/ AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N) If J-Web is enabled, the attacker could gain the same level of access of anyone actively logged into J-Web. If an administrator is logged in, the attacker could gain administrator access to J-Web. (CVSS score 8.8, vector CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H) This issue only affects Juniper Networks Junos OS devices with HTTP/HTTPS services enabled. Junos OS devices with HTTP/HTTPS services disabled are not affected. If HTTP/HTTPS services are enabled, the following command will show the httpd processes: user@device&gt; show system processes | match http 5260 - S 0:00.13 /usr/sbin/httpd-gk -N 5797 - I 0:00.10 /usr/sbin/httpd --config /jail/var/etc/httpd.conf To summarize: If HTTP/HTTPS services are disabled, there is no impact from this vulnerability. If HTTP/HTTPS services are enabled and J-Web is not in use, this vulnerability has a CVSS score of 5.9 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N). If J-Web is enabled, this vulnerability has a CVSS score of 8.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H). Juniper SIRT has received a single report of this vulnerability being exploited in the wild. Out of an abundance of caution, we are notifying customers so they can take appropriate actions. Indicators of Compromise: The /var/log/httpd.log may have indicators that commands have injected or files being accessed. The device administrator can look for these indicators by searching for the string patterns &quot;=*;*&amp;&quot; or &quot;*%3b*&amp;&quot; in /var/log/httpd.log, using the following command: user@device&gt; show log httpd.log | match &quot;=*;*&amp;|=*%3b*&amp;&quot; If this command returns any output, it might be an indication of malicious attempts or simply scanning activities. Rotated logs should also be reviewed, using the following command: user@device&gt; show log httpd.log.0.gz | match &quot;=*;*&amp;|=*%3b*&amp;&quot; user@device&gt; show log httpd.log.1.gz | match &quot;=*;*&amp;|=*%3b*&amp;&quot; Note that a skilled attacker would likely remove these entries from the local log file, thus effectively eliminating any reliable signature that the device had been attacked. This issue affects Juniper Networks Junos OS 12.3 versions prior to 12.3R12-S16; 12.3X48 versions prior to 12.3X48-D101, 12.3X48-D105; 14.1X53 versions prior to 14.1X53-D54; 15.1 versions prior to 15.1R7-S7; 15.1X49 versions prior to 15.1X49-D211, 15.1X49-D220; 16.1 versions prior to 16.1R7-S8; 17.2 versions prior to 17.2R3-S4; 17.3 versions prior to 17.3R3-S8; 17.4 versions prior to 17.4R2-S11, 17.4R3-S2; 18.1 versions prior to 18.1R3-S10; 18.2 versions prior to 18.2R2-S7, 18.2R3-S4; 18.3 versions prior to 18.3R2-S4, 18.3R3-S2; 18.4 versions prior to 18.4R1-S7, 18.4R3-S2 ; 18.4 version 18.4R2 and later versions; 19.1 versions prior to 19.1R1-S5, 19.1R3-S1; 19.1 version 19.1R2 and later versions; 19.2 versions prior to 19.2R2; 19.3 versions prior to 19.3R2-S3, 19.3R3; 19.4 versions prior to 19.4R1-S2, 19.4R2; 20.1 versions prior to 20.1R1-S1, 20.1R2.","fixes":[],"analysis":[{"url":"https://github.com/tuanha2000vn/hasskit","affectedVersion":"3.1.0","fixVersion":"3.1.1","results":[{"score":0.7609604,"message":"fool proof url modification auto correct http and /abcd/xyz user accidentally put in","hash":"a75d40f4d1359c8d371df163c2777a74ceb6db8d"},{"score":0.68915486,"message":"Change websocket getstate to http getstate because for some unknown reason, websocket got fuckup for a few urls.","hash":"9727869700e857b2916038d901c78796a6ce86c0"},{"score":0.26900724,"message":"clear the confusion about locale: gd.localeData.savedLocale,","hash":"917e411b0a9efcb08ae4e920add05c4197ca49fd"},{"score":0.06384254,"message":"Merge pull request #27 from tuanha2000vn/remove-devicelocale","hash":"958a1a1c6bedc2a17495b96236be26c84002e41a"},{"score":0.033604894,"message":"remove unused code","hash":"5f23f3cd9b4ae199a49153f2bc50eb4d1b57718e"},{"score":0.030268647,"message":"Remove devicelocale","hash":"9548dadbf14249e18136274e2a57676e16f3ea00"}]}]}