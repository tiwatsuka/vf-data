{"cve":"CVE-2020-5268","description":"In Saml2 Authentication Services for ASP.NET versions before 1.0.2, and between 2.0.0 and 2.6.0, there is a vulnerability in how tokens are validated in some cases. Saml2 tokens are usually used as bearer tokens - a caller that presents a token is assumed to be the subject of the token. There is also support in the Saml2 protocol for issuing tokens that is tied to a subject through other means, e.g. holder-of-key where possession of a private key must be proved. The Sustainsys.Saml2 library incorrectly treats all incoming tokens as bearer tokens, even though they have another subject confirmation method specified. This could be used by an attacker that could get access to Saml2 tokens with another subject confirmation method than bearer. The attacker could then use such a token to create a log in session. This vulnerability is patched in versions 1.0.2 and 2.7.0.","fixes":[{"url":"https://github.com/Sustainsys/Saml2/commit/2ebbdba792e8d66218de91e899f0f785eed670d0","hash":"2ebbdba792e8d66218de91e899f0f785eed670d0","message":"Reject non-bearer assertions - Fixes #103"}],"analysis":[{"url":"https://github.com/Sustainsys/Saml2","affectedVersion":"v1.0.1","fixVersion":"v1.0.2","results":[{"score":1.0,"message":"Reject non-bearer assertions - Fixes #103","hash":"2ebbdba792e8d66218de91e899f0f785eed670d0"},{"score":0.0,"message":"Update for release","hash":"d05d7945751f73f55d44fde9796a7b848ed9eb6a"}]},{"url":"https://github.com/Sustainsys/Saml2","affectedVersion":"v2.0.0","fixVersion":"v2.1.0","results":[{"score":0.7254294,"message":"Added back net461 target - Fixes #1026","hash":"93f0e31cba3a789852bf40b62d84b243a4fbbb60"},{"score":0.4449908,"message":"GetIdentityProvider notification - Use it in ACS command/Saml2Response validation - Update notification initialization to more modern syntax.","hash":"d6dff1102e068387da781f97a4ed407ec3e146b3"},{"score":0.41420668,"message":"Set attachment file name for metadata on download - Tidy up some incorrect references to SustainsysIT","hash":"0e62c0785d3e5dac43a7d2cca13067d4d3354293"},{"score":0.39021954,"message":"Remove incorrect signing key setter - Those are never used, as the signature is validated separately. - Those keys are the SP signing keys, not the Idp signing keys.","hash":"9dfacfc7d784fe961fccc5eec735767bf3a95358"},{"score":0.34698203,"message":"Apply headers in owin module","hash":"95b33355869d4e9474a24ac4c223c88353d2e80c"},{"score":0.3187809,"message":"Apply headers in MVC module","hash":"32c50bb4a33d74f418e65690ce4a4aa5ad77f706"},{"score":0.29464847,"message":"Update realeasenotes for release","hash":"f0f7cfc57eff78d5d9354aa2718c342ba684ae29"},{"score":0.14690274,"message":"Remove incorrect docs link","hash":"0c95ca4d8a80c3e7ccf8cc360f49fbd3be069c2b"},{"score":0.14641976,"message":"Apply headers in ASP.NET Core2 module","hash":"de5de2abcbaa4e247016c5bf5e408d173adb7e06"},{"score":0.1453128,"message":"Create XML doc files - Fixes #1014 - Bump VersionInfo - next release will be 2.1.0","hash":"a11998c2f9013cdc6251c0e9554479af016abc8b"},{"score":0.11948717,"message":"Add idp selection for aspnetcore.","hash":"9a6449e3db8f87cc8f1bc5e8c8ecebb6b5b3da00"}]},{"url":"https://github.com/Sustainsys/Saml2","affectedVersion":"v2.6.0","fixVersion":"v2.7.0","results":[{"score":0.9512149,"message":"Reject non-bearer assertions - Fixes #103","hash":"abb7d0cd3151bc497e0fb27ed21fa54413c7e8d3"},{"score":0.2801927,"message":"Update for release","hash":"0ed0ddd73ce03e825591302e671f2851280737eb"},{"score":0.05260317,"message":"Make PostConfigure public - Fixes #1184","hash":"701d06b3145b974b89d854b51d3851fe41876c04"},{"score":0.050622657,"message":"feat: Add optional compatibility option to support non-complaint IDPs that do not sign their LogOut responses.","hash":"341c8840d8c01ea6cc17f198458d11b254ee49ee"},{"score":0.038061492,"message":"Update tests - Test on LogoutResponse only as LogoutRequest should not be affected - Update other test now that message name is checked before signature","hash":"2abcd52f640ea0af570fcca209ed5e372de2b501"},{"score":0.0035273836,"message":"Compatibility flag should not affect LogoutRequests","hash":"cd2d62d132db4d980e37116286c6f585bc6e9c70"},{"score":0.0027935393,"message":"Compat flag to allow unsigned logout response - Fixes #446 - Closes #590 - Closes #924","hash":"cf1285de7eca0a1d0058f9a28445874558afffa6"},{"score":0.0026350964,"message":"Update README.md","hash":"e66e52e5d29a0504c1b383a10f2aed74730abf82"},{"score":4.6957997E-4,"message":"Allow releases from non-master branch","hash":"a6a079aaf436ffb6c366027a5ff27976255dc73a"}]}]}