{"cve":"CVE-2020-11026","description":"In affected versions of WordPress, files with a specially crafted name when uploaded to the Media section can lead to script execution upon accessing the file. This requires an authenticated user with privileges to upload files. This has been patched in version 5.4.1, along with all the previously affected versions via a minor release (5.3.3, 5.2.6, 5.1.5, 5.0.9, 4.9.14, 4.8.13, 4.7.17, 4.6.18, 4.5.21, 4.4.22, 4.3.23, 4.2.27, 4.1.30, 4.0.30, 3.9.31, 3.8.33, 3.7.33).","fixes":[],"analysis":[{"url":"https://github.com/WordPress/wordpress-develop","affectedVersion":"5.3.3","fixVersion":"5.4.0","results":[{"score":0.39590636,"message":"Script Loader: In `wp_default_packages_inline_scripts()`, make sure the root URL middleware is registered before using the media middleware.","hash":"e4edcf98457e35b0334a745736f3906ab12d3e6c"},{"score":0.38476703,"message":"Media: Improve wording for error message on failed post-processing of uploaded images.","hash":"3125c21cc41d0a7c7cc2afadd2e038ce1a3a6c33"},{"score":0.37977868,"message":"Script Loader: Remove unnecessary reference sign from function definitions in script loader.","hash":"f40c6c9ebe6490eebd4d716d0796f29b59fa963d"},{"score":0.36025333,"message":"Media: After [46375], enable JavaScript translations for the `media-views` script.","hash":"5f600eb32a3931df8321182b87cca22940960db3"},{"score":0.3187796,"message":"Docs: Miscellaneous docs fixes and improvements.","hash":"ac6cb23470ecd49d0eec4b3a16b921194cc5a4d1"},{"score":0.31744853,"message":"Docs: Switch to typed array notation for the docs for asset dependency functions.","hash":"e07cf22fd043c72190560a05157eacb6efeae874"},{"score":0.28031364,"message":"Users: When creating the first user on installation, populate the Website profile field with the site URL.","hash":"d592888f36b0c9887e1f14f1b1b2c2e7637f92d5"},{"score":0.2762281,"message":"I18N: Replace `upload_max_filesize`, `php.ini`, `MAX_FILE_SIZE` with placeholders in upload error strings.","hash":"3ff0ef5030e02096fde762f69ab52e3f9f6f12e7"},{"score":0.27378425,"message":"Coding Standards: Use strict comparison in `wp-admin/user/admin.php`.","hash":"50aa7f980c11ca9770543030eb51b3aa7289882f"},{"score":0.27184218,"message":"Accessibility: Widgets: Restore missing string in script loader.","hash":"753ffe3968e59c774848e15abefff9c7920715bf"},{"score":0.27164075,"message":"Docs: Improve comments in some `wp-admin` files per the documentation standards.","hash":"89dc54ee0c03f41db9b5fa7ce51877150ffcec49"}]},{"url":"https://github.com/WordPress/wordpress-develop","affectedVersion":"5.2.6","fixVersion":"5.3.0","results":[{"score":0.42614844,"message":"Uploads: Improve the error message shown when all attempts to create image sub-sizes fail.","hash":"468629720ce383f0b1a611fb9bb2a4f83a509ce1"},{"score":0.40628004,"message":"Tests: Update unit tests to account for the removal of old `wp-a11y` from the loaded scripts in [46179].","hash":"a87122688b3040db92791cae7954f57424c4db9a"},{"score":0.36125067,"message":"Script Loader: Remove old `wp-a11y` from the loaded scripts after [46167] and [46169].","hash":"aeac7fe2e79207501a8fdf95f801a482165b483f"},{"score":0.35076725,"message":"Script Loader: Remove unnecessary `jquery` dependency for `wp-sanitize.js`.","hash":"f56c63a5d2d9387e0df936e183a0a44f56470e26"},{"score":0.34310967,"message":"Fix unit tests after [45456]. The query string is a bit different but the results are the same.","hash":"3337e709ee3734dcce37480ab6e16f7c5eb5ae20"},{"score":0.34226885,"message":"Escape the output in `wp_ajax_upload_attachment()`.","hash":"a04e391085379eba9f9788f08e2b95746bf07655"},{"score":0.33903703,"message":"Script Loader: In `wp_default_packages_inline_scripts()`, make sure the root URL middleware is registered before using the media middleware.","hash":"7f5049eff8b7dc5aff13e405932bbe3e87d9b46a"},{"score":0.33527988,"message":"Build/Test Tools: Remove stray `+` introduced in [45979].","hash":"2d4521d82ae897aed34c64e85a537c4e95fb81cc"},{"score":0.32568064,"message":"Update wp.a11y.speak() to sanitize HTML before display.","hash":"c957e2573e7911c772ec85eb9f339ee34a9fd470"},{"score":0.32316864,"message":"Script Loader: Introduce HTML5 support for scripts and styles.","hash":"5fdf48c0ec7a554bbc25002109359976783e2e92"},{"score":0.3172715,"message":"Remove the extra call for wp-sanitize from the script loader.","hash":"e1665da9224289bb9cd2c646645ce8d17f92c007"}]},{"url":"https://github.com/WordPress/wordpress-develop","affectedVersion":"5.1.5","fixVersion":"5.2.0","results":[{"score":0.4987482,"message":"Site health: fix usage of max_execution_time. When PHP is run from the cli the default is 0.","hash":"99458493177c3126ede1adc011ec50658cb41630"},{"score":0.33827665,"message":"Site health: - Prevent fatal errors from timeouts on the Tools => Site Health => Info tab. - Use the `get_dirsize()` and `recurse_dirsize()` functions to calculate directory sizes. The results are cached. - Introduce \"timeout protection\" in `recurse_dirsize()`.","hash":"d5d4979921a7ce1d004885223ff77f3619e5c255"},{"score":0.29368076,"message":"PHPCS: Fix WPCS violations in [45104].","hash":"c8913b375eceb06cff3496fec8c5783d6f81f27b"},{"score":0.29320905,"message":"Site Health: Enable JavaScript translations for the `site-health` script.","hash":"18e373dea461bc7a72fc558eeb2dc6a8a5ac14e8"},{"score":0.2843926,"message":"Build/Test Tools: Fix validation error in multisite PHPUnit configuration file.","hash":"d80e627fdf840b5bd4c5d34a7621a39bf633e948"},{"score":0.2771907,"message":"Build: Fix formatting issues introduced in [44740].","hash":"41e264fe550dc984c2f99e88dbc9301e3e2eb82c"},{"score":0.25220358,"message":"Site Health: Use `wp_get_upload_dir()` instead of `wp_upload_dir()`, remove duplicate call.","hash":"a0ca5afd8977b5a3857084d9cb1bd345166e2f21"},{"score":0.22322707,"message":"Site health: Load the \"Info\" tab immediately and notify the user while gathering site data. Changes the Info tab to work similarly to the Status tab: it does separate request to fetch the directories sizes and doesnt \"block\" the loading of the page.","hash":"05981179e4d026ff5703cdd24bb14b387a73736d"},{"score":0.22058813,"message":"Plugins: Introduce `is_wp_version_compatible()` and `is_php_version_compatible()` for checking compatibility with the current WordPress or PHP version.","hash":"78e868e4c750d5aeafe7e054b5415643f7310ace"},{"score":0.21634926,"message":"Docs: Improve documentation for various `WP_Filesystem_Base` methods and extending classes.","hash":"0152c18cd2bb8915ac1852fe4bc089a556fa3494"},{"score":0.21216421,"message":"Admin: Introduce the Site Health screens.","hash":"dad6b61cfb6fa3016f5f469e4b2c6a8b39b6f046"}]},{"url":"https://github.com/WordPress/wordpress-develop","affectedVersion":"5.0.9","fixVersion":"5.1.0","results":[{"score":0.49238008,"message":"Scripts: Ensure sub-directory WordPress installs can load polyfill scripts.","hash":"c7cc0cebe000b683c2762692318a7e0c951ed87f"},{"score":0.4898605,"message":"Block Editor: Fix the WordPress packages and vendor script registration.","hash":"15fa394a0157e1328e5c618aca93314140c5ef03"},{"score":0.47422677,"message":"Script/Style Dependencies: Make sure that inline scripts for handles without a source are printed.","hash":"244f435e226864fb85ec599a8753e4e8eb7bab9c"},{"score":0.46136183,"message":"Script Loader: Fix metadata being registered as an inline script.","hash":"e14e84a7c5367612d0f50c4d33b24b594b15ffd4"},{"score":0.43172655,"message":"Script Loader: Load unminified package vendor scripts when `SCRIPT_DEBUG` is set.","hash":"3e6b45360db3366e2ecbc817d4ff967c6a9870ab"},{"score":0.4158886,"message":"Media: In `_wp_handle_upload()`, check if the file was properly uploaded before checking its size.","hash":"0baa8ae85c670d338e78e408f8d6e301c6410c86"},{"score":0.4151987,"message":"Core Editor: Specify script versions for the WordPress packages and their vendor dependencies.","hash":"6e546d482d15a313e40ee9ff53fbb59d6e1b2eaf"},{"score":0.40100068,"message":"Script loader: Adjust JS packages registration.","hash":"8909554d2e76dc97c66a0b9f87f77e3ee9aac8f7"},{"score":0.39555517,"message":"Script loading: Fix regression after [43738].","hash":"26c034a044971307de5e35f53b7060175c257485"},{"score":0.3912344,"message":"I18N: Add JavaScript translation support.","hash":"8d897837aa961d76212aa8d3c67f3c64d9cc17a2"},{"score":0.38735536,"message":"Docs: Improve inline documentation for `WP_Scripts`.","hash":"ecf24cd57219fa6c2641a6a0868471ccbf1a798e"}]},{"url":"https://github.com/WordPress/wordpress-develop","affectedVersion":"4.9.14","fixVersion":"5.0.0","results":[{"score":0.38974664,"message":"Core Editor: Specify script versions for the WordPress packages and their vendor dependencies.","hash":"9e8f5dde8622daed6845f91dcdc652d53ce65096"},{"score":0.372217,"message":"REST API: Fix permissions error message in post statuses controller.","hash":"b11a2cf987ebf669108b0742de153116b6a9e73c"},{"score":0.26610598,"message":"Script Loader: Add translator comments and remove textdomains.","hash":"8dbb161323540bcbcfb52245b73688db30829aac"},{"score":0.24979636,"message":"Block Editor: Fix the WordPress packages and vendor script registration.","hash":"94b478183f4afe4b71e6b9eeff6c92a5370cf931"},{"score":0.24202812,"message":"REST API: Load missing required file for multisite users","hash":"bc6c4962e94c966c491a4436708cb3518ea245eb"},{"score":0.22452196,"message":"Script Loader: Fix metadata being registered as an inline script.","hash":"cf0f8e82b5876579dba72a82e4bc3b2debbf83b7"},{"score":0.21947323,"message":"Scripts: Fix a PHP error in admin-ajax calls.","hash":"9d9854594b7561c6fe11fdbba93166cecc5b79f5"},{"score":0.20602289,"message":"I18N: Improve JavaScript translation support.","hash":"c4bffce143d824e0dea0815fcf8adb304fd574e6"},{"score":0.19151767,"message":"Script/Style Dependencies: Make sure that inline scripts for handles without a source are printed.","hash":"91f1b57473d5afb5a789ea86a1b4b62ba47abfc6"},{"score":0.17721717,"message":"I18N: Add JavaScript translation support.","hash":"4f05bb81f609559f865a85687166b9d7881639d2"},{"score":0.17176467,"message":"Help/About: Minor updates.","hash":"d64723a8b95a697e393f160ea1884011fc75ccba"}]}]}